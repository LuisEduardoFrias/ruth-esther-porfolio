---
import Layout from '@/layouts/Layout.astro'
import Nota from '@/components/Nota.astro'
---

<Layout title="Análisis de Satisfacción del Cliente" description="Portafolio profesional de Ruth Esther, Data Analyst.">
   <section class="p-6 md:p-8 lg:p-10 bg-white rounded-lg shadow-lg">
      <h1 data-key="customer-satisfaction" class="text-3xl font-bold text-purple-800 mb-6 border-l-4 border-purple-600 pl-4">
         Análisis de Satisfacción del Cliente
      </h1>

      <p class="mb-6 text-gray-700 leading-relaxed">
         Este proyecto se centra en el <strong class="text-purple-700">análisis de la satisfacción del cliente</strong> a través de datos de encuestas.
         El objetivo es <strong class="text-purple-700">identificar los factores clave que influyen en la satisfacción</strong>
         y proporcionar información para mejorar la calidad del servicio, utilizando <strong class="text-purple-700">Power BI</strong> para la exploración y visualización de los datos.
      </p>

      <div class="mb-8">
         <h2 class="text-2xl font-semibold text-gray-800 mb-4">Demostración Interactiva</h2>
         <p class="text-gray-600 mb-4">
            Aquí puedes explorar el dashboard interactivo que desarrollé. Usa los filtros para segmentar las respuestas de los clientes por Región, Edad, Género, Tiempo de Respuesta y Resolución del Problema.
         </p>

         <div class="flex flex-col gap-4 mb-6 overflow-x-scroll no-scrollbar">
            
            <div class="flex flex-col gap-2 p-3 border border-gray-200 rounded-md bg-gray-50">
               <label class="font-medium text-gray-700">Región</label>
               <div class="flex flex-wrap gap-4">
                  <label for="region-sat-all" class="flex items-center gap-2 text-sm text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <input id="region-sat-all" checked name="region-sat" class="accent-purple-700 w-4 h-4" type="radio"> Todas
                  </label>
                  <label for="region-sat-norte" class="flex items-center gap-2 text-sm text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <input id="region-sat-norte" name="region-sat" class="accent-purple-700 w-4 h-4" type="radio"> Norte
                  </label>
                  <label for="region-sat-sur" class="flex items-center gap-2 text-sm text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <input id="region-sat-sur" name="region-sat" class="accent-purple-700 w-4 h-4" type="radio"> Sur
                  </label>
                  <label for="region-sat-este" class="flex items-center gap-2 text-sm text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <input id="region-sat-este" name="region-sat" class="accent-purple-700 w-4 h-4" type="radio"> Este
                  </label>
                  <label for="region-sat-oeste" class="flex items-center gap-2 text-sm text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <input id="region-sat-oeste" name="region-sat" class="accent-purple-700 w-4 h-4" type="radio"> Oeste
                  </label>
               </div>
            </div>

            <div class="flex flex-col gap-2 p-3 border border-gray-200 rounded-md bg-gray-50">
               <label class="font-medium text-gray-700">Resolución del Problema</label>
               <div class="flex flex-wrap gap-4">
                  
                  <label for="res-all" class="text-sm custom-radio flex items-center gap-2 text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <span for="res-all" class="w-4 h-4 border-2 border-gray-300 rounded-full flex items-center justify-center transition-all duration-200"></span>
                     <input id="res-all" checked name="resolucion" class="accent-purple-700 w-4 h-4" type="radio"> Todos
                  </label>
                  
                  <label for="res-si" class="text-sm custom-radio flex items-center gap-2 text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <span for="res-si" class="w-4 h-4 border-2 border-gray-300 rounded-full flex items-center justify-center transition-all duration-200"></span>
                     <input id="res-si" name="resolucion" class="accent-purple-700 w-4 h-4" type="radio"> Sí
                  </label>
                  <label for="res-no" class="text-sm custom-radio flex items-center gap-2 text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <span for="res-no" class="w-4 h-4 border-2 border-gray-300 rounded-full flex items-center justify-center transition-all duration-200"></span>
                     <input id="res-no" name="resolucion" class="accent-purple-700 w-4 h-4" type="radio"> No
                  </label>
                  <label for="res-parcial" class="text-sm custom-radio flex items-center gap-2 text-gray-800 cursor-pointer hover:text-purple-700 transition-colors duration-200">
                     <span for="res-parcial" class="w-4 h-4 border-2 border-gray-300 rounded-full flex items-center justify-center transition-all duration-200"></span>
                     <input id="res-parcial" name="resolucion" class="accent-purple-700 w-4 h-4" type="radio"> Parcialmente
                  </label>
               </div>
            </div>
         </div>
         
         <div class="relative min-h-[300px] flex justify-center items-center">
            <img id="img-sat-default" src="/images/dashboardSatisfaccion-1.jpg" class="w-full h-auto object-contain rounded-md shadow-md transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - General" />
            <img id="img-sat-norte" src="/images/dashboardSatisfaccion-2.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Región Norte" />
            <img id="img-sat-sur" src="/images/dashboardSatisfaccion-3.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Región Sur" />
            <img id="img-sat-este" src="/images/dashboardSatisfaccion-4.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Región Este" />
            <img id="img-sat-oeste" src="/images/dashboardSatisfaccion-5.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Región Oeste" />
            <img id="img-sat-si" src="/images/dashboardSatisfaccion-6.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Problema Resuelto: Sí" />
            <img id="img-sat-no" src="/images/dashboardSatisfaccion-7.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Problema Resuelto: No" />
            <img id="img-sat-parcial" src="/images/dashboardSatisfaccion-8.jpg" class="w-full h-auto object-contain rounded-md shadow-md absolute top-0 left-0 hidden transition-opacity duration-300 ease-in-out" alt="Dashboard de Satisfacción del Cliente - Problema Resuelto: Parcialmente" />
         </div>
      </div>
      
      <div class="mt-8 pt-6 border-t border-gray-200">
         <h2 class="text-2xl font-semibold text-gray-800 mb-4">Contexto y Requisitos del Proyecto</h2>
         <p class="mb-4 text-gray-700 leading-relaxed">
            Como analista de datos, mi objetivo fue analizar las encuestas de satisfacción del cliente para identificar los principales factores que influyen en su satisfacción. Los datos provienen de la tabla <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">SatisfaccionCliente</code>, incluyendo <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">ID_Encuesta</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Fecha_Encuesta</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Region</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Edad</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Genero</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Calificacion_Servicio</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Tiempo_Respuesta</code>, <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Resolucion_Problema</code> y <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Comentarios</code>.
         </p>
         
         <h3 class="text-xl font-semibold text-gray-800 mb-3">Técnicas y Habilidades Demostradas:</h3>
         <ul class="list-disc list-inside space-y-2 text-gray-700 mb-6 pl-4">
            <li>
               <strong class="text-purple-700">Exploración y Preparación de Datos:</strong> Análisis inicial de la estructura de datos y distribución de calificaciones para identificar patrones.
            </li>
            <li>
               <strong class="text-purple-700">Creación de Columnas Calculadas:</strong> Definición de <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Satisfaccion_Alto</code> para categorizar los niveles de satisfacción.
            </li>
            <li>
               <strong class="text-purple-700">Cálculo de Medidas DAX Clave:</strong> Implementación de <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Promedio Calificacion</code> y <code class="bg-gray-100 text-purple-800 px-1 py-0.5 rounded text-sm">Porcentaje Satisfaccion Alto</code> para cuantificar la satisfacción general.
            </li>
            <li>
               <strong class="text-purple-700">Diseño de Visualizaciones Informadoras:</strong> Creación de gráficos de barras para distribución de calificaciones y comparación por región, gráficos de pastel para distribución de satisfacción, y tablas para analizar el impacto del tiempo de respuesta y la resolución del problema.
            </li>
            <li>
               <strong class="text-purple-700">Implementación de Segmentadores Detallados:</strong> Añadido de filtros por Región, Edad, Género, Tiempo de Respuesta y Resolución del Problema para un análisis multifacético.
            </li>
         </ul>

         <p class="text-gray-700 leading-relaxed">
            Este análisis proporciona a la empresa insights valiosos para <strong class="text-purple-700">mejorar la experiencia del cliente</strong>, optimizar procesos de servicio y dirigir esfuerzos hacia áreas de mayor impacto en la satisfacción.
         </p>
      </div>
      
      <Nota />

   </section>
</Layout>

<style>
   /* Estilos personalizados para el contenedor del scroll para ocultar la barra */
   .no-scrollbar {
      -ms-overflow-style: none;  /* IE and Edge */
      scrollbar-width: none;  /* Firefox */
   }
   .no-scrollbar::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera*/
   }

   /* Estilos para los radio buttons personalizados */
   .custom-radio input[type="radio"] {
      /* Oculta el input de radio original*/
      display: none;
   }

   .custom-radio span {
      /* Estilo base para el círculo personalizado */
      display: inline-block;
      width: 1rem; /* Ancho del círculo */
      height: 1rem; /* Alto del círculo */
      border: 2px solid #ccc; /* Borde del círculo */
      background-color: #f0f0f0; /* Color de fondo del círculo */
      vertical-align: middle; /* Alinea el círculo con el texto */
      margin-right: 0.3125rem; /* Espacio entre el círculo y el texto */
      cursor: pointer; /* Indica que es clickeable */
      position: relative; /* Necesario para el pseudo-elemento */
      border-radius: 50%; /* Hace que sea un círculo */
      transition: all 0.2s ease-in-out; /* Suaviza las transiciones */
   }
   
   /* Estilo cuando el input de radio está seleccionado */
   .custom-radio:has(input[type="radio"]:checked) span {
      background-color: #6d28d9; /* Color de fondo cuando está seleccionado (morado oscuro) */
      border-color: #6d28d9; /* Color del borde cuando está seleccionado */
   }
   
   /* Marca de verificación dentro del círculo */
   .custom-radio input[type="radio"]:checked + span::after {
      content: ''; /* Contenido vacío para el pseudo-elemento */
      display: block;
      width: 0.5rem; /* Ancho de la marca */
      height: 0.5rem; /* Alto de la marca */
      background-color: #fff; /* Color de la marca (blanco) */
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%); /* Centra la marca */
      border-radius: 50%; /* Hace que la marca sea un círculo pequeño */
   }

   /* Efecto hover */
   .custom-radio:hover span {
      border-color: #6d28d9; /* Color del borde al pasar el ratón */
   }
</style>

<script>
   import { $ } from '@/lib/dom-selector'

   const $regionSatAll = $('#region-sat-all');
   const $regionSatNorte = $('#region-sat-norte');
   const $regionSatSur = $('#region-sat-sur');
   const $regionSatEste = $('#region-sat-este');
   const $regionSatOeste = $('#region-sat-oeste');
   
   const $resAll = $('#res-all');
   const $resSi = $('#res-si');
   const $resNo = $('#res-no');
   const $resParcial = $('#res-parcial');
   
   const $imgSatDefault = $('#img-sat-default');
   const $imgSatNorte = $('#img-sat-norte');
   const $imgSatSur = $('#img-sat-sur');
   const $imgSatEste = $('#img-sat-este');
   const $imgSatOeste = $('#img-sat-oeste');
   const $imgSatSi = $('#img-sat-si');
   const $imgSatNo = $('#img-sat-no');
   const $imgSatParcial = $('#img-sat-parcial');

   function updateSatisfactionImage() {
      const selectedRegion = document.querySelector('input[name="region-sat"]:checked').id;
      const selectedResolution = document.querySelector('input[name="resolucion"]:checked').id;

      // Hide all images first
      [$imgSatDefault, $imgSatNorte, $imgSatSur, $imgSatEste, $imgSatOeste, $imgSatSi, $imgSatNo, $imgSatParcial].forEach(img => img.classList.add('hidden'));

      // Logic to show the correct image
      if (selectedResolution !== 'res-all') {
          // If a specific resolution is selected, show that image
          if (selectedResolution === 'res-si') $imgSatSi.classList.remove('hidden');
          if (selectedResolution === 'res-no') $imgSatNo.classList.remove('hidden');
          if (selectedResolution === 'res-parcial') $imgSatParcial.classList.remove('hidden');
      } else if (selectedRegion !== 'region-sat-all') { // 'region-sat-all' is the default for region
          // If no specific resolution is selected, show region-specific images
          if (selectedRegion === 'region-sat-norte') $imgSatNorte.classList.remove('hidden');
          if (selectedRegion === 'region-sat-sur') $imgSatSur.classList.remove('hidden');
          if (selectedRegion === 'region-sat-este') $imgSatEste.classList.remove('hidden');
          if (selectedRegion === 'region-sat-oeste') $imgSatOeste.classList.remove('hidden');
      } else {
          // Default: show the default image if no other filter applies
          if (selectedRegion === 'region-sat-all' && selectedResolution === 'res-all') {
            $imgSatDefault.classList.remove('hidden');
          }
      }
      
      // Additional specific combinations if needed.
      // For this example, I'm assuming resolution filter takes precedence, then region, then default.
      if (selectedResolution === 'res-si') {
          $imgSatSi.classList.remove('hidden');
      } else if (selectedResolution === 'res-no') {
          $imgSatNo.classList.remove('hidden');
      } else if (selectedResolution === 'res-parcial') {
          $imgSatParcial.classList.remove('hidden');
      } else { // selectedResolution is 'res-all'
          if (selectedRegion === 'region-sat-norte') {
              $imgSatNorte.classList.remove('hidden');
          } else if (selectedRegion === 'region-sat-sur') {
              $imgSatSur.classList.remove('hidden');
          } else if (selectedRegion === 'region-sat-este') {
              $imgSatEste.classList.remove('hidden');
          } else if (selectedRegion === 'region-sat-oeste') {
              $imgSatOeste.classList.remove('hidden');
          } else if (selectedRegion === 'region-sat-all') {
              $imgSatDefault.classList.remove('hidden');
          }
      }
   }

   // Attach event listeners
   [$regionSatAll, $regionSatNorte, $regionSatSur, $regionSatEste, $regionSatOeste, $resAll, $resSi, $resNo, $resParcial].forEach(radio => {
       radio.addEventListener('change', updateSatisfactionImage);
   });

   // Initial image display based on default checked radios
   updateSatisfactionImage();
</script>
